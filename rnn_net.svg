<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="772" height="1012" viewBox="0 0 579 759"><g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 755)"><title>G</title><polygon fill="#fff" stroke="none" points="-4 4 -4 -755 575 -755 575 4 -4 4"/><text x="285.5" y="-735.8" font-family="Times,serif" font-size="14" text-anchor="middle">rnn_net</text><g id="node1" class="node"><title>n1</title><g id="a_node1"><a xlink:title="[[string &quot;function get_rnn(input_size, rnn_size)...&quot;]]:11"><ellipse cx="285" cy="-117" fill="none" stroke="#000" rx="84.219" ry="26.741"/><text x="285" y="-120.8" font-family="Times,serif" font-size="14" text-anchor="middle">next_h (1)</text><text x="285" y="-105.8" font-family="Times,serif" font-size="14" text-anchor="middle">module = nn.Tanh</text></a></g></g><g id="node2" class="node"><title>n2</title><g id="a_node2"><a xlink:title="[[C]]:-1"><ellipse cx="285" cy="-27" fill="none" stroke="#000" rx="51.99" ry="26.741"/><text x="285" y="-30.8" font-family="Times,serif" font-size="14" text-anchor="middle">Node2</text><text x="285" y="-15.8" font-family="Times,serif" font-size="14" text-anchor="middle">input = {}</text></a></g></g><g id="edge1" class="edge"><title>n1-&gt;n2</title><path fill="none" stroke="#000" d="M285,-90.0731C285,-81.9993 285,-72.9428 285,-64.2961"/><polygon fill="#000" stroke="#000" points="288.5 -64.046 285 -54.046 281.5 -64.046 288.5 -64.046"/></g><g id="node3" class="node"><title>n3</title><g id="a_node3"><a xlink:title="[[string &quot;function get_rnn(input_size, rnn_size)...&quot;]]:10"><ellipse cx="285" cy="-218" fill="none" stroke="#000" rx="124.176" ry="37.453"/><text x="285" y="-229.3" font-family="Times,serif" font-size="14" text-anchor="middle">added_h (3)</text><text x="205" y="-214.3" font-family="Times,serif" font-size="14" text-anchor="start">module = nn.CAddTable</text><text x="285" y="-199.3" font-family="Times,serif" font-size="14" text-anchor="middle">mapindex = {Node4,Node5}</text></a></g></g><g id="edge2" class="edge"><title>n3-&gt;n1</title><path fill="none" stroke="#000" d="M285,-180.417C285,-171.802 285,-162.626 285,-154.035"/><polygon fill="#000" stroke="#000" points="288.5 -153.924 285 -143.924 281.5 -153.924 288.5 -153.924"/></g><g id="node4" class="node"><title>n4</title><g id="a_node4"><a xlink:title="[[string &quot;function get_rnn(input_size, rnn_size)...&quot;]]:8"><ellipse cx="138" cy="-319" fill="none" stroke="#000" rx="138.389" ry="26.741"/><text x="138" y="-322.8" font-family="Times,serif" font-size="14" text-anchor="middle">i2h (4)</text><text x="138" y="-307.8" font-family="Times,serif" font-size="14" text-anchor="middle">module = nn.Linear(128 -&gt; 128)</text></a></g></g><g id="edge3" class="edge"><title>n4-&gt;n3</title><path fill="none" stroke="#000" d="M175.094,-293.018C190.809,-282.435 209.495,-269.85 226.961,-258.088"/><polygon fill="#000" stroke="#000" points="229.079 -260.881 235.418 -252.392 225.169 -255.075 229.079 -260.881"/></g><g id="node5" class="node"><title>n5</title><g id="a_node5"><a xlink:title="[[string &quot;function get_rnn(input_size, rnn_size)...&quot;]]:9"><ellipse cx="433" cy="-319" fill="none" stroke="#000" rx="138.389" ry="26.741"/><text x="433" y="-322.8" font-family="Times,serif" font-size="14" text-anchor="middle">h2h (5)</text><text x="433" y="-307.8" font-family="Times,serif" font-size="14" text-anchor="middle">module = nn.Linear(128 -&gt; 128)</text></a></g></g><g id="edge4" class="edge"><title>n5-&gt;n3</title><path fill="none" stroke="#000" d="M395.653,-293.018C379.831,-282.435 361.019,-269.85 343.434,-258.088"/><polygon fill="#000" stroke="#000" points="345.177 -255.043 334.919 -252.392 341.285 -260.861 345.177 -255.043"/></g><g id="node6" class="node"><title>n6</title><g id="a_node6"><a xlink:title="[[string &quot;function get_rnn(input_size, rnn_size)...&quot;]]:4"><ellipse cx="160" cy="-409" fill="none" stroke="#000" rx="94.068" ry="26.741"/><text x="160" y="-412.8" font-family="Times,serif" font-size="14" text-anchor="middle">input (6)</text><text x="160" y="-397.8" font-family="Times,serif" font-size="14" text-anchor="middle">module = nn.Identity</text></a></g></g><g id="edge5" class="edge"><title>n6-&gt;n4</title><path fill="none" stroke="#000" d="M153.518,-382.073C151.478,-373.911 149.186,-364.744 147.003,-356.011"/><polygon fill="#000" stroke="#000" points="150.332 -354.898 144.511 -346.046 143.541 -356.596 150.332 -354.898"/></g><g id="node7" class="node"><title>n7</title><g id="a_node7"><a xlink:title="[[string &quot;function get_rnn(input_size, rnn_size)...&quot;]]:5"><ellipse cx="410" cy="-409" fill="none" stroke="#000" rx="94.068" ry="26.741"/><text x="410" y="-412.8" font-family="Times,serif" font-size="14" text-anchor="middle">prev_h (7)</text><text x="410" y="-397.8" font-family="Times,serif" font-size="14" text-anchor="middle">module = nn.Identity</text></a></g></g><g id="edge6" class="edge"><title>n7-&gt;n5</title><path fill="none" stroke="#000" d="M416.776,-382.073C418.933,-373.822 421.358,-364.544 423.662,-355.727"/><polygon fill="#000" stroke="#000" points="427.05 -356.606 426.193 -346.046 420.278 -354.836 427.05 -356.606"/></g><g id="node8" class="node"><title>n8</title><g id="a_node8"><a xlink:title="[[C]]:-1-1"><ellipse cx="172" cy="-510" fill="none" stroke="#000" rx="70.566" ry="37.453"/><text x="172" y="-521.3" font-family="Times,serif" font-size="14" text-anchor="middle">Node8</text><text x="130" y="-506.3" font-family="Times,serif" font-size="14" text-anchor="start">input = {}</text><text x="172" y="-491.3" font-family="Times,serif" font-size="14" text-anchor="middle">selectindex = 1</text></a></g></g><g id="edge7" class="edge"><title>n8-&gt;n6</title><path fill="none" stroke="#000" d="M167.566,-472.417C166.521,-463.802 165.409,-454.626 164.368,-446.035"/><polygon fill="#000" stroke="#000" points="167.82 -445.43 163.142 -435.924 160.871 -446.273 167.82 -445.43"/></g><g id="node9" class="node"><title>n9</title><g id="a_node9"><a xlink:title="[[C]]:-1-2"><ellipse cx="354" cy="-510" fill="none" stroke="#000" rx="70.566" ry="37.453"/><text x="354" y="-521.3" font-family="Times,serif" font-size="14" text-anchor="middle">Node9</text><text x="312" y="-506.3" font-family="Times,serif" font-size="14" text-anchor="start">input = {}</text><text x="354" y="-491.3" font-family="Times,serif" font-size="14" text-anchor="middle">selectindex = 2</text></a></g></g><g id="edge8" class="edge"><title>n9-&gt;n7</title><path fill="none" stroke="#000" d="M373.901,-473.818C379.285,-464.299 385.107,-454.008 390.47,-444.526"/><polygon fill="#000" stroke="#000" points="393.566 -446.162 395.443 -435.735 387.473 -442.715 393.566 -446.162"/></g><g id="node10" class="node"><title>n10</title><g id="a_node10"><a xlink:title="[[C]]:-1-mnode"><ellipse cx="251" cy="-611" fill="none" stroke="#000" rx="80.415" ry="26.741"/><text x="251" y="-614.8" font-family="Times,serif" font-size="14" text-anchor="middle">Node10</text><text x="251" y="-599.8" font-family="Times,serif" font-size="14" text-anchor="middle">nSplitOutputs = 2</text></a></g></g><g id="edge9" class="edge"><title>n10-&gt;n8</title><path fill="none" stroke="#000" d="M230.861,-584.762C223.062,-574.989 213.926,-563.54 205.209,-552.616"/><polygon fill="#000" stroke="#000" points="207.934 -550.42 198.961 -544.787 202.463 -554.786 207.934 -550.42"/></g><g id="edge10" class="edge"><title>n10-&gt;n9</title><path fill="none" stroke="#000" d="M276.726,-585.273C287.68,-574.744 300.731,-562.201 312.96,-550.446"/><polygon fill="#000" stroke="#000" points="315.658 -552.708 320.442 -543.255 310.807 -547.661 315.658 -552.708"/></g><g id="node11" class="node"><title>n11</title><g id="a_node11"><a xlink:title="[[C]]:-1"><ellipse cx="251" cy="-701" fill="none" stroke="#000" rx="51.99" ry="26.741"/><text x="251" y="-704.8" font-family="Times,serif" font-size="14" text-anchor="middle">Node11</text><text x="251" y="-689.8" font-family="Times,serif" font-size="14" text-anchor="middle">input = {}</text></a></g></g><g id="edge11" class="edge"><title>n11-&gt;n10</title><path fill="none" stroke="#000" d="M251,-674.073C251,-665.999 251,-656.943 251,-648.296"/><polygon fill="#000" stroke="#000" points="254.5 -648.046 251 -638.046 247.5 -648.046 254.5 -648.046"/></g></g></svg>